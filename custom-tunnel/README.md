# π‡ Custom Tunnel System

μ§μ ‘ λ§λ“  λ΅μ»¬ ν„°λ„λ§ μ‹μ¤ν…μ…λ‹λ‹¤. localtunnelμ²λΌ λ΅μ»¬ μ„λ²„λ¥Ό μ™Έλ¶€μ— κ³µκ°ν•  μ μμµλ‹λ‹¤.

## π― μ‘λ™ μ›λ¦¬

```
[λ΅μ»¬ μ„λ²„:3000]  β†β†’  [ν„°λ„ ν΄λΌμ΄μ–ΈνΈ]
                           β†• (WebSocket)
                      [ν„°λ„ μ„λ²„:8080]
                           β†• (HTTP)
                      [μ™Έλ¶€ μ‚¬μ©μ λΈλΌμ°μ €]
```

1. **ν„°λ„ μ„λ²„**: WebSocketμΌλ΅ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ λ°›κ³ , HTTP μ”μ²­μ„ μ¤‘κ³„
2. **ν„°λ„ ν΄λΌμ΄μ–ΈνΈ**: μ„λ²„μ™€ WebSocket μ—°κ²°, λ΅μ»¬ μ„λ²„λ΅ μ”μ²­ ν¬μ›λ”©
3. **ν…μ¤νΈ μ„λ²„**: ν„°λ„μ„ ν†µν•΄ κ³µκ°ν•  κ°„λ‹¨ν• μ›Ή μ„λ²„

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
custom-tunnel/
β”β”€β”€ server/          # ν„°λ„ μ„λ²„ (μ¤‘κ³„ μ—­ν• )
β”‚   β”β”€β”€ index.js
β”‚   β””β”€β”€ package.json
β”β”€β”€ client/          # ν„°λ„ ν΄λΌμ΄μ–ΈνΈ (λ΅μ»¬ μ‹¤ν–‰)
β”‚   β”β”€β”€ index.js
β”‚   β””β”€β”€ package.json
β”β”€β”€ test-server/     # ν…μ¤νΈμ© μ›Ή μ„λ²„
β”‚   β”β”€β”€ app.js
β”‚   β””β”€β”€ package.json
β””β”€β”€ README.md
```

## π€ λΉ λ¥Έ μ‹μ‘

### 1λ‹¨κ³„: μμ΅΄μ„± μ„¤μΉ

```bash
# ν„°λ„ μ„λ²„
cd server
npm install

# ν„°λ„ ν΄λΌμ΄μ–ΈνΈ
cd ../client
npm install

# ν…μ¤νΈ μ„λ²„
cd ../test-server
npm install
```

### 2λ‹¨κ³„: ν„°λ„ μ„λ²„ μ‹¤ν–‰ (ν„°λ―Έλ„ 1)

```bash
cd server
npm start
```

μ¶λ ¥:

```
π€ Custom Tunnel Server Starting...
π ν„°λ„ μ„λ²„ μ‹¤ν–‰ μ¤‘: http://localhost:8080
WebSocket μ„λ²„ μ¤€λΉ„ μ™„λ£
```

### 3λ‹¨κ³„: ν…μ¤νΈ μ„λ²„ μ‹¤ν–‰ (ν„°λ―Έλ„ 2)

```bash
cd test-server
npm start
```

μ¶λ ¥:

```
π€ ν…μ¤νΈ μ„λ²„ μ‹¤ν–‰ μ¤‘: http://localhost:3000
```

### 4λ‹¨κ³„: ν„°λ„ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰ (ν„°λ―Έλ„ 3)

```bash
cd client
npm start 3000
```

μ¶λ ¥:

```
π” ν„°λ„ ν΄λΌμ΄μ–ΈνΈ μ‹μ‘...
π“ λ΅μ»¬ μ„λ²„: http://localhost:3000
π ν„°λ„ μ„λ²„: ws://localhost:8080
β…ν„°λ„ μ„λ²„ μ—°κ²° μ„±κ³µ!

π‰ ν„°λ„ μƒμ„± μ™„λ£!
π“ ν„°λ„ URL: http://localhost:8080/abc12345
π”‘ ν„°λ„ ID: abc12345

μ΄μ  ν„°λ„ URLλ΅ μ ‘μ†ν•λ©΄ λ΅μ»¬ μ„λ²„λ΅ μ—°κ²°λ©λ‹λ‹¤!
```

### 5λ‹¨κ³„: ν…μ¤νΈ

λΈλΌμ°μ €μ—μ„ ν„°λ„ URLλ΅ μ ‘μ†:

```
http://localhost:8080/abc12345
```

μ„±κ³µν•λ©΄ ν…μ¤νΈ μ„λ²„μ νμ΄μ§€κ°€ λ³΄μ…λ‹λ‹¤! π‰

## π’΅ μ‚¬μ© μμ‹

### λ‹¤λ¥Έ ν¬νΈ μ‚¬μ©

```bash
# ν¬νΈ 8000μ—μ„ μ‹¤ν–‰ μ¤‘μΈ μ„λ²„λ¥Ό ν„°λ„λ΅ κ³µκ°
cd client
npm start 8000
```

### μμ‹ μ React/Next.js/Vite μ•± κ³µκ°

```bash
# React/Vite μ•± μ‹¤ν–‰ (ν¬νΈ 3000)
npm start  # λλ” npm run dev

# λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ ν„°λ„ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰
cd custom-tunnel/client
npm start 3000
```

**β¨ Vite μ„¤μ • λ¶ν•„μ”!**

- Host ν—¤λ”κ°€ μλ™μΌλ΅ `localhost`λ΅ λ³€κ²½λ©λ‹λ‹¤
- `vite.config.js`μ— `allowedHosts` μ„¤μ • μ¶”κ°€ν•  ν•„μ” μ—†μ
- ν”„λ΅μ νΈ νμΌ μμ • μ—†μ΄ λ°”λ΅ μ‚¬μ© κ°€λ¥!

## π” κ° μ»΄ν¬λ„νΈ μ„¤λ…

### ν„°λ„ μ„λ²„ (server/)

- **μ—­ν• **: WebSocket μ„λ²„ + HTTP ν”„λ΅μ‹
- **ν¬νΈ**: 8080 (λ³€κ²½ κ°€λ¥)
- **κΈ°λ¥**:
  - ν΄λΌμ΄μ–ΈνΈ WebSocket μ—°κ²° κ΄€λ¦¬
  - μ™Έλ¶€ HTTP μ”μ²­μ„ WebSocketμΌλ΅ μ „λ‹¬
  - ν΄λΌμ΄μ–ΈνΈ μ‘λ‹µμ„ μ™Έλ¶€ μ‚¬μ©μμ—κ² μ „λ‹¬

### ν„°λ„ ν΄λΌμ΄μ–ΈνΈ (client/)

- **μ—­ν• **: λ΅μ»¬ μ„λ²„μ™€ ν„°λ„ μ„λ²„ μ—°κ²°
- **κΈ°λ¥**:
  - ν„°λ„ μ„λ²„μ— WebSocket μ—°κ²°
  - ν„°λ„ μ„λ²„λ΅λ¶€ν„° μ”μ²­ λ°›κΈ°
  - λ΅μ»¬ μ„λ²„λ΅ μ”μ²­ μ „λ‹¬
  - μ‘λ‹µμ„ ν„°λ„ μ„λ²„λ΅ μ „μ†΅

**μ‚¬μ©λ²•**:

```bash
node index.js [λ΅μ»¬ν¬νΈ] [ν„°λ„μ„λ²„URL] [https]

# μμ‹
node index.js 3000                              # HTTP localhost:3000μ„ κ³µκ°
node index.js 3001 ws://localhost:8080 https    # HTTPS localhost:3001μ„ κ³µκ°
npm run start:https                              # HTTPS 3001 (λ‹¨μ¶• λ…λ Ή)
```

**HTTPS λ΅μ»¬ μ„λ²„ μ—°κ²° μ‹:**

- μ„Έ λ²μ§Έ μΈμλ΅ `https` λλ” `true` μ „λ‹¬
- μμ²΄ μ„λ… μΈμ¦μ„λ„ μλ™μΌλ΅ ν—μ©λ©λ‹λ‹¤

### ν…μ¤νΈ μ„λ²„ (test-server/)

- **μ—­ν• **: ν„°λ„ ν…μ¤νΈμ© κ°„λ‹¨ν• μ›Ή μ„λ²„
- **ν¬νΈ**: 3000
- **κΈ°λ¥**:
  - ν™ νμ΄μ§€ μ κ³µ
  - API μ—”λ“ν¬μΈνΈ (/api/test, /api/echo)
  - μΈν„°λ™ν‹°λΈ ν…μ¤νΈ UI

## π“ ν†µμ‹  νλ¦„

### μ™Έλ¶€ μ”μ²­ β†’ λ΅μ»¬ μ„λ²„

```
1. λΈλΌμ°μ € β†’ GET http://localhost:8080/abc12345/
2. ν„°λ„ μ„λ²„ β†’ WebSocket λ©”μ‹μ§€ { type: "request", ... }
3. ν„°λ„ ν΄λΌμ΄μ–ΈνΈ β†’ GET http://localhost:3000/
4. λ΅μ»¬ μ„λ²„ β†’ μ‘λ‹µ
5. ν„°λ„ ν΄λΌμ΄μ–ΈνΈ β†’ WebSocket { type: "response", ... }
6. ν„°λ„ μ„λ²„ β†’ HTTP μ‘λ‹µ
7. λΈλΌμ°μ € β†’ νμ΄μ§€ λ λ”λ§ β…
```

## π› οΈ μ»¤μ¤ν„°λ§μ΄μ§•

### ν¬νΈ λ³€κ²½

**ν„°λ„ μ„λ²„ ν¬νΈ λ³€κ²½** (`server/index.js`):

```javascript
const PORT = 9000; // 8080μ—μ„ 9000μΌλ΅ λ³€κ²½
```

**ν…μ¤νΈ μ„λ²„ ν¬νΈ λ³€κ²½** (`test-server/app.js`):

```javascript
const PORT = 5000; // 3000μ—μ„ 5000μΌλ΅ λ³€κ²½
```

### μ‹¤μ  μ„λ²„μ— λ°°ν¬

1. VPS μ„λ²„ μ¤€λΉ„ (AWS, DigitalOcean λ“±)
2. μ„λ²„μ— Node.js μ„¤μΉ
3. ν„°λ„ μ„λ²„ μ½”λ“ μ—…λ΅λ“
4. ν¬νΈλ¥Ό 80 λλ” 443μΌλ΅ λ³€κ²½
5. Nginxλ΅ λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„¤μ •
6. SSL μΈμ¦μ„ μ„¤μΉ (Let's Encrypt)
7. ν΄λΌμ΄μ–ΈνΈμ—μ„ `wss://your-domain.com` μ—°κ²°

## π† localtunnelκ³Ό λΉ„κµ

| κΈ°λ¥         | Custom Tunnel            | localtunnel  |
| ------------ | ------------------------ | ------------ |
| λΉ„μ©         | λ¬΄λ£ (μ„λ²„ ν•„μ” μ‹ μ λ£) | λ¬΄λ£         |
| μ„¤μ •         | μ§μ ‘ μ„λ²„ μ‹¤ν–‰ ν•„μ”      | μ¦‰μ‹ μ‚¬μ©    |
| μ»¤μ¤ν„°λ§μ΄μ§• | μ™„μ „ μ μ–΄ β…             | μ ν•μ        |
| ν•™μµ         | μ›λ¦¬ μ΄ν•΄ β…             | λΈ”λ™λ°•μ¤     |
| μ•μ •μ„±       | μ§μ ‘ κ΄€λ¦¬                | μ„λΉ„μ¤ μμ΅΄  |
| λΉ„λ°€λ²νΈ     | λ¶ν•„μ” β…                | κ³µκ° IP ν•„μ” |

## π› νΈλ¬λΈ”μν…

### μΌλ°μ μΈ μ¤λ¥

**"ECONNREFUSED" μ¤λ¥**

- **λ¬Έμ **: ν„°λ„ μ„λ²„κ°€ μ‹¤ν–‰λμ§€ μ•μ
- **ν•΄κ²°**: `cd server && npm start`λ΅ μ„λ²„ λ¨Όμ € μ‹¤ν–‰

**"Tunnel not available" (503)**

- **λ¬Έμ **: ν„°λ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°λμ§€ μ•μ
- **ν•΄κ²°**: ν„°λ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ

**"Bad Gateway: socket hang up" (502)**

- **λ¬Έμ **: λ΅μ»¬ μ„λ²„ μ—°κ²°μ΄ λμ–΄μ§
- **ν•΄κ²°**: μµμ‹  λ²„μ „ μ‚¬μ© (v1.1.0+), λ΅μ»¬ μ„λ²„ μ‹¤ν–‰ ν™•μΈ
- **μƒμ„Έ**: [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) μ°Έμ΅°

### λ” λ§μ€ λ„μ›€μ΄ ν•„μ”ν•μ‹ κ°€μ”?

μƒμ„Έν• λ¬Έμ  ν•΄κ²° κ°€μ΄λ“λ” [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) νμΌμ„ μ°Έμ΅°ν•μ„Έμ”.

## π“ ν•™μµ ν¬μΈνΈ

μ΄ ν”„λ΅μ νΈλ¥Ό ν†µν•΄ λ°°μΈ μ μλ” κ²ƒλ“¤:

1. **WebSocket ν†µμ‹ **: μ–‘λ°©ν–¥ μ‹¤μ‹κ°„ ν†µμ‹ 
2. **λ¦¬λ²„μ¤ ν”„λ΅μ‹**: μ”μ²­ μ¤‘κ³„ λ©”μ»¤λ‹μ¦
3. **λΉ„λ™κΈ° μ²λ¦¬**: Promise, async/await
4. **HTTP ν”„λ΅ν† μ½**: μ”μ²­/μ‘λ‹µ κµ¬μ΅°
5. **λ„¤νΈμ›ν‚Ή κΈ°μ΄**: ν¬νΈ, μ†μΌ“, ν„°λ„λ§

## π€ λ‹¤μ λ‹¨κ³„

ν„μ¬λ” λ΅μ»¬ ν…μ¤νΈμ©μ…λ‹λ‹¤. μ‹¤μ λ΅ μ‚¬μ©ν•λ ¤λ©΄:

1. β… VPS μ„λ²„ μ¤€λΉ„
2. β… λ„λ©”μΈ μ—°κ²°
3. β… SSL μΈμ¦μ„ μ„¤μΉ
4. β… μ„λΈλ„λ©”μΈ λ™μ  μƒμ„±
5. β… μΈμ¦ μ‹μ¤ν… μ¶”κ°€
6. β… λ΅κ·Έ λ° λ¨λ‹ν„°λ§

## π“ λΌμ΄μ„ μ¤

MIT License - μμ λ΅­κ² μ‚¬μ©ν•μ„Έμ”!

---

**λ§λ“  μ΄μ **: localtunnelμ μ›λ¦¬λ¥Ό μ΄ν•΄ν•κ³  μ§μ ‘ κµ¬ν„ν•΄λ³΄κΈ° μ„ν•΄ π“
